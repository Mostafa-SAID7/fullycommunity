
@import '../../shared/styles/variables';
@import '../../shared/styles/mixins';

.admin-layout {
  min-height: 100vh;
  background: linear-gradient(135deg, $bg-secondary 0%, rgba($primary-100, 0.3) 50%, rgba($indigo-100, 0.3) 100%);
  @include flex-start;
  flex-direction: column;

  // Mobile overlay for sidebar - enhanced responsive design
  .mobile-overlay {
    position: fixed;
    inset: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1025; // Above sticky header (1020) but below sidebar (1030)
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px); // Safari support
    cursor: pointer;
    touch-action: none; // Prevent scrolling when overlay is visible
    user-select: none;

    // Enhanced mobile overlay - darker on smaller screens
    @media screen and (max-width: 575.98px) {
      background-color: rgba(0, 0, 0, 0.65);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    // Hide on desktop/tablet
    @include respond-to('md') {
      display: none !important;
    }

    // Smooth fade animation
    animation: fadeInOverlay 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  // Main content area - properly split layout
  // Sidebar is fixed, content area adjusts with margin
  .main-content {
    position: fixed;
    top: $nav-height; // Start right after header
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: calc(100vh - #{$nav-height});
    overflow: hidden;

    // Content area - fills remaining space and allows page changes via router-outlet
    .content-area {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      overflow-y: auto;
      overflow-x: hidden;
      transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1), padding 0.3s ease;
      padding: 0.5rem;
      -webkit-overflow-scrolling: touch; // Smooth scrolling on iOS
      overscroll-behavior: contain; // Prevent scroll chaining
      box-sizing: border-box;

      // Desktop/Tablet: Adjust left position based on sidebar state
      &.with-sidebar-open {
        left: 16rem; // Space for expanded sidebar

        @include respond-below('lg') {
          left: 14rem;
        }

        @include respond-below('md') {
          left: 12rem;
        }

        @include respond-below('sm') {
          // Mobile: Sidebar overlays, content stays full width
          left: 0;
          padding: 0;
        }
      }

      &.with-sidebar-closed {
        left: 4rem; // Space for collapsed sidebar (icon-only)

        @include respond-below('md') {
          left: 4rem; // Keep space for icon-only sidebar on tablet
        }

        @include respond-below('sm') {
          // Mobile: Sidebar hidden, content takes full width
          left: 0;
          padding: 0;
        }
      }

      // Ensure router-outlet content fills the area
      router-outlet+* {
        display: block;
        width: 100%;
        min-height: 100%;
      }
    }
  }
}

// Toast Container
// -----------------------------------------------------------------------------

.toast-container {
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index: $z-index-toast;
}

// Animations
// -----------------------------------------------------------------------------

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

@keyframes fadeInOverlay {
  from {
    opacity: 0;
    backdrop-filter: blur(0px);
    -webkit-backdrop-filter: blur(0px);
  }

  to {
    opacity: 1;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes bounce {

  0%,
  20%,
  53%,
  80%,
  100% {
    transform: translate3d(0, 0, 0);
  }

  40%,
  43% {
    transform: translate3d(0, -8px, 0);
  }

  70% {
    transform: translate3d(0, -4px, 0);
  }

  90% {
    transform: translate3d(0, -2px, 0);
  }
}

// Dark Mode Support
// -----------------------------------------------------------------------------

@include dark-mode {
  .admin-layout {
    background: linear-gradient(135deg, $dark-bg-primary 0%, rgba($dark-bg-secondary, 0.8) 50%, rgba($dark-bg-tertiary, 0.6) 100%);

    .mobile-overlay {
      background-color: rgba(0, 0, 0, 0.8);

      @include respond-below('md') {
        background-color: rgba(0, 0, 0, 0.85);
      }
    }
  }
}